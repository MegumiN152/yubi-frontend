"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[743],{90901:function(me,W,a){a.r(W);var V=a(15009),P=a.n(V),N=a(99289),d=a.n(N),J=a(97857),p=a.n(J),z=a(5574),f=a.n(z),O=a(73829),ae=a(35312),y=a(2453),T=a(10932),j=a(18922),w=a(35653),b=a(34041),A=a(99481),R=a(4393),H=a(7134),M=a(59720),te=a(96074),F=a(9276),D=a(67294),x=a(33076),Q=a(88942),S=a(69215),X=a(87588),e=a(85893),ue=function(){var Y=(0,Q.Z)(),I=f()(Y,1),t=I[0],u={current:1,pageSize:4,sortField:"createTime",sortOrder:"desc"},s=(0,D.useState)(p()({},u)),i=f()(s,2),r=i[0],c=i[1],k=(0,ae.useModel)("@@initialState"),o=k.initialState,C=o!=null?o:{},_=C.currentUser,pe=(0,D.useState)(),se=f()(pe,2),fe=se[0],Ee=se[1],ge=(0,D.useState)(0),_e=f()(ge,2),ye=_e[0],Pe=_e[1],ve=(0,D.useState)(!0),ie=f()(ve,2),q=ie[0],le=ie[1],$=(0,D.useRef)(null),Oe=(0,D.useState)(!1),oe=f()(Oe,2),je=oe[0],ee=oe[1],be=(0,D.useState)(null),de=f()(be,2),B=de[0],Ce=de[1],Te=S.u_.confirm,G=function(){var E=d()(P()().mark(function n(){var l,g,L;return P()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return le(!0),m.prev=1,m.next=4,(0,O.MW)(r);case 4:l=m.sent,l.data?(Ee((g=l.data.records)!==null&&g!==void 0?g:[]),Pe((L=l.data.total)!==null&&L!==void 0?L:0),l.data.records&&l.data.records.forEach(function(Z){if(Z.status==="succeed"){var U,ne=JSON.parse((U=Z.genChart)!==null&&U!==void 0?U:"{}");ne.title=void 0,Z.genChart=JSON.stringify(ne)}})):y.ZP.error("\u83B7\u53D6\u6211\u7684\u56FE\u8868\u5931\u8D25"),m.next=11;break;case 8:m.prev=8,m.t0=m.catch(1),y.ZP.error("\u83B7\u53D6\u6211\u7684\u56FE\u8868\u5931\u8D25\uFF0C"+m.t0.message);case 11:le(!1);case 12:case"end":return m.stop()}},n,null,[[1,8]])}));return function(){return E.apply(this,arguments)}}(),De=function(){var E=d()(P()().mark(function n(l){var g;return P()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:g={id:l};try{Te({title:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u56FE\u8868\u5417\uFF1F",icon:(0,e.jsx)(X.Z,{}),content:"\u5220\u9664\u540E\u5C06\u65E0\u6CD5\u6062\u590D\uFF0C\u8BF7\u786E\u8BA4\u3002",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){return d()(P()().mark(function Z(){var U;return P()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,(0,O.WL)(g);case 3:U=v.sent,U.data===!0?G():y.ZP.error("\u5220\u9664\u56FE\u8868\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"),v.next=10;break;case 7:v.prev=7,v.t0=v.catch(0),y.ZP.error("\u5220\u9664\u56FE\u8868\u5931\u8D25"+v.t0.message);case 10:case"end":return v.stop()}},Z,null,[[0,7]])}))()},onCancel:function(){console.log("\u53D6\u6D88\u5220\u9664")}})}catch(m){y.ZP.error("\u5220\u9664\u56FE\u8868\u5931\u8D25"+m.message)}case 2:case"end":return h.stop()}},n)}));return function(l){return E.apply(this,arguments)}}(),Me=function(n){Ce(n),ee(!0),t.setFieldsValue({id:n.id,name:n.name,goal:n.goal,chartType:n.chartType,chartData:n.chartData})},ce=function(){ee(!1)},Se=function(){var E=d()(P()().mark(function n(l){var g;return P()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return ee(!1),console.log(l),h.prev=2,h.next=5,(0,O.B0)(l);case 5:g=h.sent,g!=null&&g.data?y.ZP.success("\u6B63\u5728\u91CD\u65B0\u751F\u6210\uFF0C\u7A0D\u540E\u8BF7\u5728\u6211\u7684\u56FE\u8868\u9875\u9762\u5237\u65B0\u67E5\u770B"):y.ZP.error("\u5206\u6790\u5931\u8D25,"+"".concat(g.message)),h.next=12;break;case 9:h.prev=9,h.t0=h.catch(2),y.ZP.error("\u5206\u6790\u5931\u8D25\uFF0C"+h.t0.message);case 12:case"end":return h.stop()}},n,null,[[2,9]])}));return function(l){return E.apply(this,arguments)}}(),he=function(){re();var n=setInterval(G,5e3);$.current=n},re=function(){$.current&&(clearInterval($.current),$.current=null)};return(0,D.useEffect)(function(){return G(),he(),function(){re()}},[r]),(0,e.jsxs)("div",{className:"my-chart-page",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u56FE\u8868\u540D\u79F0",enterButton:!0,loading:q,onSearch:function(n){c(p()(p()({},u),{},{name:n}))}}),(0,e.jsx)(T.ZP,{onClick:G,style:{marginLeft:16},loading:q,children:"\u5237\u65B0"}),(0,e.jsx)(T.ZP,{onClick:he,style:{marginLeft:8},children:"\u5F00\u59CB\u81EA\u52A8\u5237\u65B0"}),(0,e.jsx)(T.ZP,{onClick:re,style:{marginLeft:8},children:"\u505C\u6B62\u81EA\u52A8\u5237\u65B0"})]}),(0,e.jsx)("div",{className:"margin-16"}),(0,e.jsx)(S.u_,{title:"\u8868\u5355",visible:je,onCancel:ce,footer:[(0,e.jsx)(T.ZP,{onClick:ce,children:"\u53D6\u6D88"},"cancel"),(0,e.jsx)(T.ZP,{type:"primary",onClick:function(){t.submit()},children:"\u91CD\u65B0\u751F\u6210"},"submit")],children:B&&(0,e.jsxs)(j.Z,{form:t,onFinish:Se,children:[(0,e.jsx)(j.Z.Item,{label:"\u56FE\u8868id",name:"id",initialValue:B.id,children:(0,e.jsx)(w.Z,{})}),(0,e.jsx)(j.Z.Item,{label:"\u56FE\u8868\u540D\u79F0",name:"name",initialValue:B.name,children:(0,e.jsx)(w.Z,{})}),(0,e.jsx)(j.Z.Item,{label:"\u5206\u6790\u76EE\u6807",name:"goal",initialValue:B.goal,children:(0,e.jsx)(w.Z,{})}),(0,e.jsx)(j.Z.Item,{label:"\u539F\u59CB\u6570\u636E",name:"chartType",initialValue:B.chartType,children:(0,e.jsxs)(b.Z,{placeholder:"\u8BF7\u9009\u62E9\u56FE\u8868\u7C7B\u578B",onChange:function(n){return t.setFieldsValue({chartType:n})},children:[(0,e.jsx)(b.Z.Option,{value:"\u6298\u7EBF\u56FE",children:"\u6298\u7EBF\u56FE"}),(0,e.jsx)(b.Z.Option,{value:"\u67F1\u72B6\u56FE",children:"\u67F1\u72B6\u56FE"}),(0,e.jsx)(b.Z.Option,{value:"\u5806\u53E0\u56FE",children:"\u5806\u53E0\u56FE"}),(0,e.jsx)(b.Z.Option,{value:"\u997C\u56FE",children:"\u997C\u56FE"}),(0,e.jsx)(b.Z.Option,{value:"\u96F7\u8FBE\u56FE",children:"\u96F7\u8FBE\u56FE"})]})}),(0,e.jsx)(j.Z.Item,{label:"\u539F\u59CB\u6570\u636E",name:"chartData",initialValue:B.chartData,children:(0,e.jsx)("textarea",{rows:15,cols:50})})]})}),(0,e.jsx)(A.Z,{grid:{gutter:16,xs:1,sm:1,md:1,lg:2,xl:2,xxl:2},pagination:{onChange:function(n,l){c(p()(p()({},r),{},{current:n,pageSize:l}))},current:r.current,pageSize:r.pageSize,total:ye},loading:q,dataSource:fe,renderItem:function(n){var l;return(0,e.jsx)(A.Z.Item,{children:(0,e.jsxs)(R.Z,{style:{width:"100%"},children:[(0,e.jsx)(A.Z.Item.Meta,{avatar:(0,e.jsx)(H.C,{src:_&&_.userAvatar}),title:n.name,description:(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,e.jsx)("div",{children:n.chartType?"\u56FE\u8868\u7C7B\u578B"+n.chartType:void 0}),(0,e.jsx)("div",{children:n.createTime}),(0,e.jsx)("div",{style:{marginTop:1},children:(0,e.jsx)(T.ZP,{type:"primary",onClick:function(){De(n.id)},children:"\u5220\u9664"})})]})}),(0,e.jsxs)(e.Fragment,{children:[n.status==="wait"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(M.ZP,{status:"warning",title:"\u5F85\u751F\u6210",subTitle:(l=n.execMessage)!==null&&l!==void 0?l:"\u5F53\u524D\u56FE\u8868\u751F\u6210\u961F\u5217\u7E41\u5FD9\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5019"})}),n.status==="running"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(M.ZP,{status:"info",title:"\u56FE\u8868\u751F\u6210\u4E2D",subTitle:n.execMessage})}),n.status==="succeed"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{marginBottom:16}}),(0,e.jsx)("p",{children:"\u5206\u6790\u76EE\u6807\uFF1A"+n.goal}),(0,e.jsx)("div",{style:{marginBottom:16}}),(0,e.jsx)(F.Z,{option:n.genChart&&JSON.parse(n.genChart)}),(0,e.jsx)(te.Z,{children:"\u7ED3\u8BBA"}),(0,e.jsx)("div",{children:n.genResult}),(0,e.jsx)("div",{style:{marginLeft:540},children:(0,e.jsx)(T.ZP,{type:"primary",onClick:function(){return Me(n)},children:"\u4FEE\u6539\u8BC9\u6C42"})})]}),n.status==="failed"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(M.ZP,{status:"error",title:"\u56FE\u8868\u751F\u6210\u5931\u8D25",subTitle:n.execMessage})})]})]})},n.id)}})]})};W.default=ue},73829:function(me,W,a){a.d(W,{B0:function(){return Y},I6:function(){return H},MW:function(){return X},VG:function(){return A},WL:function(){return T},bq:function(){return Q}});var V=a(52677),P=a.n(V),N=a(15009),d=a.n(N),J=a(97857),p=a.n(J),z=a(99289),f=a.n(z),O=a(35312);function ae(t,u){return y.apply(this,arguments)}function y(){return y=_asyncToGenerator(_regeneratorRuntime().mark(function t(u,s){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/chart/add",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:u},s||{})));case 1:case"end":return r.stop()}},t)})),y.apply(this,arguments)}function T(t,u){return j.apply(this,arguments)}function j(){return j=f()(d()().mark(function t(u,s){return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,O.request)("/api/chart/delete",p()({method:"POST",headers:{"Content-Type":"application/json"},data:u},s||{})));case 1:case"end":return r.stop()}},t)})),j.apply(this,arguments)}function w(t,u){return b.apply(this,arguments)}function b(){return b=_asyncToGenerator(_regeneratorRuntime().mark(function t(u,s){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/chart/edit",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:u},s||{})));case 1:case"end":return r.stop()}},t)})),b.apply(this,arguments)}function A(t,u,s,i){return R.apply(this,arguments)}function R(){return R=f()(d()().mark(function t(u,s,i,r){var c;return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return c=new FormData,i&&c.append("file",i),Object.keys(s).forEach(function(C){var _=s[C];_!=null&&c.append(C,P()(_)==="object"&&!(_ instanceof File)?JSON.stringify(_):_)}),o.abrupt("return",(0,O.request)("/api/chart/gen",p()({method:"POST",params:p()({},u),data:c,requestType:"form"},r||{})));case 4:case"end":return o.stop()}},t)})),R.apply(this,arguments)}function H(t,u,s,i){return M.apply(this,arguments)}function M(){return M=f()(d()().mark(function t(u,s,i,r){var c;return d()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return c=new FormData,i&&c.append("file",i),Object.keys(s).forEach(function(C){var _=s[C];_!=null&&c.append(C,P()(_)==="object"&&!(_ instanceof File)?JSON.stringify(_):_)}),o.abrupt("return",(0,O.request)("/api/chart/gen/async",p()({method:"POST",params:p()({},u),data:c,requestType:"form"},r||{})));case 4:case"end":return o.stop()}},t)})),M.apply(this,arguments)}function te(t,u,s,i){return F.apply(this,arguments)}function F(){return F=_asyncToGenerator(_regeneratorRuntime().mark(function t(u,s,i,r){var c;return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return c=new FormData,i&&c.append("file",i),Object.keys(s).forEach(function(C){var _=s[C];_!=null&&c.append(C,_typeof(_)==="object"&&!(_ instanceof File)?JSON.stringify(_):_)}),o.abrupt("return",request("/api/chart/gen/async/mq",_objectSpread({method:"POST",params:_objectSpread({},u),data:c,requestType:"form"},r||{})));case 4:case"end":return o.stop()}},t)})),F.apply(this,arguments)}function D(t,u){return x.apply(this,arguments)}function x(){return x=_asyncToGenerator(_regeneratorRuntime().mark(function t(u,s){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/chart/get",_objectSpread({method:"GET",params:_objectSpread({},u)},s||{})));case 1:case"end":return r.stop()}},t)})),x.apply(this,arguments)}function Q(t,u){return S.apply(this,arguments)}function S(){return S=f()(d()().mark(function t(u,s){return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,O.request)("/api/chart/list/page",p()({method:"POST",headers:{"Content-Type":"application/json"},data:u},s||{})));case 1:case"end":return r.stop()}},t)})),S.apply(this,arguments)}function X(t,u){return e.apply(this,arguments)}function e(){return e=f()(d()().mark(function t(u,s){return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,O.request)("/api/chart/my/list/page",p()({method:"POST",headers:{"Content-Type":"application/json"},data:u},s||{})));case 1:case"end":return r.stop()}},t)})),e.apply(this,arguments)}function ue(t,u){return K.apply(this,arguments)}function K(){return K=_asyncToGenerator(_regeneratorRuntime().mark(function t(u,s){return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/chart/update",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:u},s||{})));case 1:case"end":return r.stop()}},t)})),K.apply(this,arguments)}function Y(t,u){return I.apply(this,arguments)}function I(){return I=f()(d()().mark(function t(u,s){return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,O.request)("/api/chart/gen/retry",p()({method:"POST",headers:{"Content-Type":"application/json"},data:u},s||{})));case 1:case"end":return r.stop()}},t)})),I.apply(this,arguments)}}}]);
